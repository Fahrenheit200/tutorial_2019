/****************************************
按键顺序：（从左往右）
1.播放：每首歌都需要按下才能开始播放
2.暂停/继续：歌曲播放时，按一下暂停；暂停时，按一下继续播放
3.快进：长按可以实现快进
4.快退：长按可以实现快退
5.切歌：长按可以实现切歌
****************************************/
//OLED显示屏
#include <Wire.h>
#include <Adafruit_GFX.h>
#include <Adafruit_SSD1306.h>
 
#define OLED_RESET 0xff//not use reset pin
Adafruit_SSD1306 display(OLED_RESET);

//列出全部C调的频率
#define NTC0 -1
#define NTC1 262
#define NTC2 294
#define NTC3 330
#define NTC4 350
#define NTC5 393
#define NTC6 441
#define NTC7 495
 
#define NTCL1 131
#define NTCL2 147
#define NTCL3 165
#define NTCL4 175
#define NTCL5 196
#define NTCL6 221
#define NTCL7 248  
 
#define NTCH1 525
#define NTCH2 589
#define NTCH3 661
#define NTCH4 700
#define NTCH5 786
#define NTCH6 882
#define NTCH7 990

#define TONE_PIN 12         //蜂鸣器用6号接口
#define PLAY_PIN 25         //播放按键，灰色线
#define PAUSE_PIN 2        //暂停/继续按键，棕色线 
#define FAST_FORWARD_PIN 24 //快进按键，紫色线
#define REWIND_PIN 23       //快退按键，蓝色线
#define SWITCH_NEXT_PIN 22 //切歌按键，绿色线
#define G 10               //歌曲数目

//歌曲音调和节拍**************
//1.爱拼才会赢
int tune1[]=                 
{
  NTC5,NTC5,NTC6,
  NTCH1,NTC6,NTC5,NTC6,NTCH1,NTC6,NTC5,
  NTC3,NTC3,NTC3,NTC5,
  NTC6,NTC6,NTC5,NTCH3,NTCH3,NTCH2,NTCH1,
  NTCH2,NTCH1,NTCH2,
  NTCH3,NTCH3,NTCH2,NTCH3,NTCH2,NTCH1,NTCH2,NTCH1,NTC6
};
float durt1[]=                   
{
0.5,0.25,0.25,
1.5,0.5,0.5,0.25,0.25,0.5,0.5,
1+1+1,0.5,0.25,0.25,
1.5,0.5,0.5,0.5,0.25,0.25,0.5,
1+1+1,0.5,0.5,
0.5,0.5,0.5,0.25,0.25,0.5,0.25,0.25,0.5
};
//2.小星星
int tune2[]=  
{
 NTC1,NTC1,NTC5,NTC5,NTC6,NTC6,NTC5,
 NTC4,NTC4,NTC3,NTC3,NTC2,NTC2,NTC1,
 NTC5,NTC5,NTC4,NTC4,NTC3,NTC3,NTC2,
 NTC5,NTC5,NTC4,NTC4,NTC3,NTC3,NTC2,
 NTC1,NTC1,NTC5,NTC5,NTC6,NTC6,NTC5,
 NTC4,NTC4,NTC3,NTC3,NTC2,NTC2,NTC1
};
float durt2[]= 
{
 1,1,1,1,1,1,2,
 1,1,1,1,1,1,2,
 1,1,1,1,1,1,2,
 1,1,1,1,1,1,2,
 1,1,1,1,1,1,2,
 1,1,1,1,1,1,2, 
};
//3.两只老虎
int tune3[]=  
{
  NTC1,NTC2,NTC3,NTC1,
  NTC1,NTC2,NTC3,NTC1,
  NTC3,NTC4,NTC5,
  NTC3,NTC4,NTC5,
  NTC5,NTC6,NTC5,NTC4,NTC3,NTC1,
  NTC5,NTC6,NTC5,NTC4,NTC3,NTC1,
  NTC2,NTCL5,NTC1,
  NTC2,NTCL5,NTC1
};
float durt3[]=  
{
  1,1,1,1,
  1,1,1,1,
  1,1,2,
  1,1,2,
  0.5,0.5,0.5,0.5,1,1,
  0.5,0.5,0.5,0.5,1,1,
  1,1,2,
  1,1,2
};
//4.生日快乐
int tune4[]= 
{
  NTC5,NTC5,NTC6,NTC5,NTCH1,NTC7, 
  NTC5,NTC5,NTC6,NTC5,NTCH2,NTCH1,
  NTC5,NTC5,NTCH5,NTCH3,NTCH1,NTC7,NTC6,
  NTC0,NTC0,NTCH4,NTCH4,NTCH3,NTCH1,NTCH2,NTCH1
};
float durt4[]=  
{
  0.5,0.5,1,1,1,2,
  0.5,0.5,1,1,1,2,
  0.5,0.5,1,1,1,1,2,
  0.5,0.5,1,1,1,3  
};
//5.蜗牛
int tune5[]= 
{
  NTC3,NTC3,NTC3,NTC4,NTC3,NTC2,NTC3,NTC2,NTC1,NTC1,
  NTC1,NTC4,NTC4,NTC3,NTC2,NTC2,NTC1,NTC2,NTC3,
  NTC1,NTC5,NTC5,NTC5,NTC6,NTC5,NTC4,NTC3,NTC4,NTCL6,NTC1,
  NTC5,NTC3,NTC3,NTC3,NTC4,NTC3,NTC2,NTC2,NTC3,NTC2,NTC1,NTC1,
  NTCL5,NTC1,NTC1,NTCL5,NTC1,NTC2,NTC3,NTC4,NTC4,NTC5,NTC5,
  NTC1,NTCH1,NTC7,NTC7,NTC7,NTCH1,NTC7,NTC6,NTC6,NTC6,NTC7,NTC5,NTC3,NTC5,
  NTC1,NTC4,NTC5,NTC6,NTC6,NTC7,NTCH1,NTCH2,NTCH3,NTC5,
  NTCL5,NTC1,NTC5,NTC4,NTC4,NTC3,NTC2,NTC1,NTC1,NTCL7,NTC1
};
float durt5[]=  
{
  2,1,1,1,1,1,1,2,2,1,
  2,2,1,1,1,0.5,1,0.5,2,
  1,2,1,1,1,1,1,1,2,2,2,
  1,2,1,1,1,1,1,0.5,0.5,0.5,1,2,
  1,2,1,1,1,1,1,1,1,1,2,
  1,1,1,2,1,1,0.5,0.5,1,1,1,0.5,0.5,2,
  1,1,1,2,1,1,1,1,2,
  1,1,1,2,1,1,1,1,1,1,2
};
//6.一分钱
int tune6[]=
{
  NTC5,NTCH1,NTC6,NTCH1,NTC5,
  NTC3,NTC5,NTC2,NTC3,NTC5,NTC0,
  NTC3,NTC5,NTC6,NTCH1,NTC5,NTC6,NTC5,NTC3,NTC5,NTC1,NTC3,NTC2,NTC0,
  NTC3,NTC2,NTC1,NTC2,NTC3,
  NTC6,NTC5,NTC3,NTC5,NTC6,NTC0,
  NTC5,NTCH1,NTC6,NTC5,NTC3,NTC5,NTC2,
  NTC5,NTC2,NTC3,NTC2,NTC1
};
float durt6[]=  
{
   1,1,0.5,0.5,1,
   0.5,0.5,0.5,0.5,1,1,
   0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,1,0.5,1,1,
   0.5,0.5,0.5,0.5,1,
   0.5,0.5,0.5,0.5,1,1,
   0.5,0.5,0.5,0.5,0.5,0.5,1,
   0.5,0.5,0.5,0.5,1
};
//7.上学歌
int tune7[]= 
{
  NTC1,NTC2,NTC3,NTC1,NTC5,
  NTC6,NTC6,NTCH1,NTC6,NTC5,
  NTC6,NTC6,NTCH1,NTC5,NTC6,NTC3,
  NTC6,NTC5,NTC3,NTC5,NTC3,NTC1,NTC2,NTC3,NTC1
};
float durt7[]= 
{
  0.5,0.5,0.5,0.5,2,
  0.5,0.5,0.5,0.5,2,
  0.5,0.5,1,0.5,0.5,1,
  0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,2
};

//8.粉刷匠
int tune8[]= 
{
  NTC5,NTC3,NTC5,NTC3,NTC5,NTC3,NTC1,
  NTC2,NTC4,NTC3,NTC2,NTC5,
  NTC5,NTC3,NTC5,NTC3,NTC5,NTC3,NTC1,
  NTC2,NTC4,NTC3,NTC2,NTC1,
  NTC2,NTC2,NTC4,NTC4,NTC3,NTC1,NTC5,
  NTC2,NTC4,NTC3,NTC2,NTC5,
  NTC5,NTC3,NTC5,NTC3,NTC5,NTC3,NTC1,
  NTC2,NTC4,NTC3,NTC2,NTC1
};
float durt8[]= 
{
  0.5,0.5,0.5,0.5,0.5,0.5,1,
  0.5,0.5,0.5,0.5,2,
  0.5,0.5,0.5,0.5,0.5,0.5,1,
  0.5,0.5,0.5,0.5,2,
  0.5,0.5,0.5,0.5,0.5,0.5,1,
  0.5,0.5,0.5,0.5,2,
  0.5,0.5,0.5,0.5,0.5,0.5,1,
  0.5,0.5,0.5,0.5,1
};

//9.卖报歌
int tune9[]= 
{
  NTC5,NTC5,NTC5,NTC5,NTC5,NTC5,
  NTC3,NTC5,NTC6,NTC5,NTC2,NTC3,NTC5,
  NTC5,NTC3,NTC5,NTC3,NTC2,NTC1,NTC3,NTC2,
  NTC3,NTC3,NTC2,NTCL6,NTC1,NTC2,
  NTC6,NTC6,NTC5,NTC3,NTC6,NTC5,NTC5,NTC3,NTC2,NTC3,NTC5,
  NTC5,NTC3,NTC2,NTC3,NTC5,NTC3,NTC2,NTC3,NTCL6,NTC1,NTC2,NTC3,NTC1
};
float durt9[]= 
{
  0.5,0.5,1,0.5,0.5,1,
  0.5,0.5,0.5,0.25,0.25,0.5,0.5,1,
  0.5,0.5,0.5,0.25,0.25,0.5,0.5,1,
  0.5,0.5,1,0.5,0.5,1,
  1,0.5,0.5,0.5,0.5,1,
  0.5,0.5,0.5,0.5,1,
  0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,2
};

//10.小毛驴
int tune10[]= 
{
  NTC1,NTC1,NTC1,NTC3,NTC5,NTC5,NTC5,
  NTC5,NTC6,NTC6,NTC6,NTCH1,NTC5,
  NTC4,NTC4,NTC4,NTC6,NTC3,NTC3,NTC3,NTC3,
  NTC2,NTC2,NTC2,NTC2,NTC5,
  NTC5,NTC1,NTC1,NTC1,NTC3,NTC5,NTC5,NTC5,
  NTC5,NTC6,NTC6,NTC6,NTCH1,NTC5,
  NTC4,NTC4,NTC4,NTC6,NTC3,NTC3,NTC3,NTC3,NTC3,
  NTC3,NTC2,NTC2,NTC2,NTC3,NTC1
};
float durt10[]= 
{
  0.5,0.5,0.5,0.5,0.5,0.5,0.5,
  0.5,0.5,0.5,0.5,0.5,2,
  0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,
  0.5,0.5,0.5,0.5,1,
  0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,
  0.5,0.5,0.5,0.5,0.5,2,
  0.5,0.5,0.5,0.5,0.25,0.25,0.25,0.25,0.5,
  0.5,0.5,0.5,0.5,0.5,2
};
//**********************************

//歌曲总数组
int *tunes[G]={tune1,tune2,tune3,tune4,tune5,tune6,tune7,tune8,tune9,tune10};//频率
float *durts[G]={durt1,durt2,durt3,durt4,durt5,durt6,durt7,durt8,durt9,durt10};//节拍

//OLED显示的字*******************
//当前播放：
static const unsigned char PROGMEM str1_1[] =
{
  0x01,0x00,0x21,0x08,0x11,0x08,0x09,0x10,0x09,0x20,0x01,0x00,0x7F,0xF8,0x00,0x08,
  0x00,0x08,0x00,0x08,0x3F,0xF8,0x00,0x08,0x00,0x08,0x00,0x08,0x7F,0xF8,0x00,0x08
};/*"当",1*/
static const unsigned char PROGMEM str1_2[] =
{
  0x10,0x10,0x08,0x10,0x08,0x20,0xFF,0xFE,0x00,0x00,0x3E,0x08,0x22,0x48,0x22,0x48,
  0x3E,0x48,0x22,0x48,0x22,0x48,0x3E,0x48,0x22,0x08,0x22,0x08,0x2A,0x28,0x24,0x10  
};/*"前",2*/
static const unsigned char PROGMEM str1_3[] =
{
  0x20,0x78,0x27,0xC0,0x22,0x48,0x21,0x50,0xFB,0xFC,0x21,0x50,0x22,0x48,0x2C,0x06,
  0x33,0xF8,0xE2,0x48,0x22,0x48,0x23,0xF8,0x22,0x48,0x22,0x48,0xA3,0xF8,0x42,0x08
};/*"播",3*/
static const unsigned char PROGMEM str1_4[] =
{
  0x20,0x40,0x10,0x40,0x00,0x40,0xFE,0x80,0x20,0xFE,0x21,0x08,0x3E,0x88,0x24,0x88,
  0x24,0x88,0x24,0x50,0x24,0x50,0x24,0x20,0x44,0x50,0x54,0x88,0x89,0x04,0x02,0x02
};/*"放",4*/
static const unsigned char PROGMEM str1_5[] =
{
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x30,0x00,0x30,0x00,0x00,0x00,0x30,0x00,0x30,0x00,0x00,0x00,0x00,0x00
};/*":",5*/

//下一首：
static const unsigned char PROGMEM str2_1[] =
{
  0x00,0x00,0xFF,0xFE,0x02,0x00,0x02,0x00,0x02,0x00,0x02,0x00,0x02,0x40,0x02,0x20,
  0x02,0x10,0x02,0x08,0x02,0x08,0x02,0x00,0x02,0x00,0x02,0x00,0x02,0x00,0x02,0x00
};/*"下",1*/
static const unsigned char PROGMEM str2_2[] =
{
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFE,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
};/*"一",2*/
static const unsigned char PROGMEM str2_3[] =
{
  0x10,0x10,0x08,0x20,0xFF,0xFE,0x02,0x00,0x04,0x00,0x3F,0xF8,0x20,0x08,0x20,0x08,
  0x3F,0xF8,0x20,0x08,0x20,0x08,0x3F,0xF8,0x20,0x08,0x20,0x08,0x3F,0xF8,0x20,0x08
};/*"首",3*/
static const unsigned char PROGMEM str2_4[] =
{
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x30,0x00,0x30,0x00,0x00,0x00,0x30,0x00,0x30,0x00,0x00,0x00,0x00,0x00
};/*"：",4*/

//1.爱拼才会赢
static const unsigned char PROGMEM name1_1[] =
{
  0x00,0x08,0x01,0xFC,0x7E,0x10,0x22,0x10,0x11,0x20,0x7F,0xFE,0x42,0x02,0x82,0x04,
  0x7F,0xF8,0x04,0x00,0x07,0xF0,0x0A,0x10,0x11,0x20,0x20,0xC0,0x43,0x30,0x1C,0x0E
};/*"爱",1*/
static const unsigned char PROGMEM name1_2[] =
{
  0x11,0x04,0x10,0x84,0x10,0x88,0x10,0x00,0xFD,0xFE,0x10,0x88,0x10,0x88,0x14,0x88,
  0x18,0x88,0x33,0xFE,0xD0,0x88,0x10,0x88,0x11,0x08,0x11,0x08,0x52,0x08,0x24,0x08
};/*"拼",2*/
static const unsigned char PROGMEM name1_3[] =
{
  0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0xFF,0xFE,0x01,0x80,0x02,0x80,0x02,0x80,
  0x04,0x80,0x04,0x80,0x08,0x80,0x10,0x80,0x20,0x80,0x40,0x80,0x02,0x80,0x01,0x00
};/*"才",3*/
static const unsigned char PROGMEM name1_4[] =
{
  0x01,0x00,0x01,0x00,0x02,0x80,0x04,0x40,0x08,0x20,0x30,0x18,0xCF,0xE6,0x00,0x00,
  0x00,0x00,0x7F,0xFC,0x02,0x00,0x04,0x00,0x08,0x20,0x10,0x10,0x3F,0xF8,0x10,0x08
};/*"会",4*/
static const unsigned char PROGMEM name1_5[] =
{
  0x01,0x00,0xFF,0xFE,0x20,0x00,0x3F,0xF8,0x00,0x00,0x3F,0xF8,0x20,0x08,0x3F,0xF8,
  0x00,0x00,0x77,0xDC,0x54,0x54,0x75,0x54,0x55,0x5C,0x75,0x56,0x52,0x96,0xB4,0x62
};/*"赢",5*/

//2.小星星
static const unsigned char PROGMEM name2_1[] =
{
  0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00,0x11,0x10,0x11,0x08,0x11,0x04,
  0x21,0x04,0x21,0x02,0x41,0x02,0x81,0x02,0x01,0x00,0x01,0x00,0x05,0x00,0x02,0x00
};/*"小",1*/
static const unsigned char PROGMEM name2_2[] =
{
  0x00,0x00,0x1F,0xF0,0x10,0x10,0x1F,0xF0,0x10,0x10,0x1F,0xF0,0x01,0x00,0x11,0x00,
  0x1F,0xF8,0x21,0x00,0x41,0x00,0x1F,0xF0,0x01,0x00,0x01,0x00,0x7F,0xFC,0x00,0x00
};/*"星",2*/
static const unsigned char PROGMEM name2_3[] =
{
  0x00,0x00,0x1F,0xF0,0x10,0x10,0x1F,0xF0,0x10,0x10,0x1F,0xF0,0x01,0x00,0x11,0x00,
  0x1F,0xF8,0x21,0x00,0x41,0x00,0x1F,0xF0,0x01,0x00,0x01,0x00,0x7F,0xFC,0x00,0x00
};/*"星",3*/

//3.两只老虎
static const unsigned char PROGMEM name3_1[] =
{
  0x00,0x00,0xFF,0xFE,0x04,0x40,0x04,0x40,0x04,0x40,0x7F,0xFC,0x44,0x44,0x44,0x44,
  0x44,0x44,0x4A,0xA4,0x4A,0x94,0x51,0x14,0x42,0x04,0x40,0x04,0x40,0x14,0x40,0x08
};/*"两",1*/
static const unsigned char PROGMEM name3_2[] =
{
  0x00,0x00,0x1F,0xF0,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,
  0x1F,0xF0,0x10,0x10,0x00,0x00,0x08,0x20,0x08,0x10,0x10,0x08,0x20,0x04,0x40,0x04
};/*"只",2*/
static const unsigned char PROGMEM name3_3[] =
{
  0x02,0x00,0x02,0x08,0x3F,0xD0,0x02,0x20,0x02,0x40,0xFF,0xFE,0x01,0x00,0x02,0x00,
  0x0C,0x10,0x18,0xE0,0x2F,0x00,0x48,0x08,0x88,0x08,0x08,0x08,0x07,0xF8,0x00,0x00
};/*"老",3*/
static const unsigned char PROGMEM name3_4[] =
{
  0x01,0x00,0x01,0xF8,0x01,0x00,0x3F,0xFC,0x21,0x04,0x21,0x60,0x2F,0x88,0x21,0x08,
  0x20,0xF8,0x20,0x00,0x23,0xE0,0x22,0x20,0x22,0x20,0x44,0x24,0x48,0x24,0x90,0x1C
};/*"虎",4*/

//4.生日快乐
static const unsigned char PROGMEM name4_1[] =
{
  0x01,0x00,0x11,0x00,0x11,0x00,0x11,0x00,0x3F,0xFC,0x21,0x00,0x41,0x00,0x81,0x00,
  0x01,0x00,0x3F,0xF8,0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00,0xFF,0xFE,0x00,0x00
};/*"生",1*/
static const unsigned char PROGMEM name4_2[] =
{
  0x00,0x00,0x1F,0xF0,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x1F,0xF0,
  0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x1F,0xF0,0x10,0x10
};/*"日",2*/
static const unsigned char PROGMEM name4_3[] =
{
  0x10,0x40,0x10,0x40,0x10,0x40,0x13,0xF8,0x18,0x48,0x54,0x48,0x50,0x48,0x50,0x48,
  0x97,0xFE,0x10,0x40,0x10,0xA0,0x10,0xA0,0x11,0x10,0x11,0x10,0x12,0x08,0x14,0x06
};/*"快",3*/
static const unsigned char PROGMEM name4_4[] =
{
  0x00,0x20,0x00,0xF0,0x1F,0x00,0x10,0x00,0x11,0x00,0x21,0x00,0x21,0x00,0x3F,0xFC,
  0x01,0x00,0x09,0x20,0x09,0x10,0x11,0x08,0x21,0x04,0x41,0x04,0x05,0x00,0x02,0x00
};/*"乐",4*/

//5.蜗牛
static const unsigned char PROGMEM name5_1[] =
{
  0x20,0x00,0x21,0xFC,0x21,0x04,0xF9,0x04,0xA9,0x04,0xA9,0xFC,0xA8,0x20,0xA8,0x20,
  0xFB,0xFE,0xA2,0x22,0x22,0x52,0x2A,0x8A,0x3B,0x0A,0xEA,0x02,0x42,0x0A,0x02,0x04
};/*"蜗",1*/
static const unsigned char PROGMEM name5_2[] =
{
  0x01,0x00,0x11,0x00,0x11,0x00,0x11,0x00,0x1F,0xF8,0x21,0x00,0x41,0x00,0x01,0x00,
  0x01,0x00,0xFF,0xFE,0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00
};/*"牛",2*/

//6.一分钱
static const unsigned char PROGMEM name6_1[] =
{
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFE,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
};/*"一",1*/
static const unsigned char PROGMEM name6_2[] =
{
  0x00,0x40,0x04,0x40,0x04,0x20,0x08,0x20,0x10,0x10,0x20,0x08,0x40,0x04,0x9F,0xE2,
  0x04,0x20,0x04,0x20,0x04,0x20,0x08,0x20,0x08,0x20,0x10,0x20,0x21,0x40,0x40,0x80
};/*"分",2*/
static const unsigned char PROGMEM name6_3[] =
{
  0x10,0x50,0x10,0x48,0x3C,0x40,0x20,0x5C,0x41,0xE0,0xBC,0x40,0x10,0x5E,0x11,0xE0,
  0xFC,0x44,0x10,0x48,0x10,0x30,0x10,0x22,0x14,0x52,0x18,0x8A,0x13,0x06,0x00,0x02
};/*"钱",3*/

//7.上学歌
static const unsigned char PROGMEM name7_1[] =
{
  0x02,0x00,0x02,0x00,0x02,0x00,0x02,0x00,0x02,0x00,0x02,0x00,0x03,0xF8,0x02,0x00,
  0x02,0x00,0x02,0x00,0x02,0x00,0x02,0x00,0x02,0x00,0x02,0x00,0xFF,0xFE,0x00,0x00
};/*"上",1*/
static const unsigned char PROGMEM name7_2[] =
{
  0x22,0x08,0x11,0x08,0x11,0x10,0x00,0x20,0x7F,0xFE,0x40,0x02,0x80,0x04,0x1F,0xE0,
  0x00,0x40,0x01,0x80,0xFF,0xFE,0x01,0x00,0x01,0x00,0x01,0x00,0x05,0x00,0x02,0x00
};/*"学",2*/
static const unsigned char PROGMEM name7_3[] =
{
  0x00,0x20,0xFF,0x20,0x02,0x20,0x7A,0x7E,0x4A,0x42,0x7A,0x84,0x00,0x10,0xFF,0x10,
  0x02,0x10,0x7A,0x10,0x4A,0x28,0x4A,0x28,0x7A,0x28,0x02,0x44,0x0A,0x44,0x04,0x82
};/*"歌",3*/

//8.粉刷匠
static const unsigned char PROGMEM name8_1[] =
{
  0x10,0x10,0x10,0x50,0x94,0x50,0x54,0x50,0x58,0x88,0x10,0x88,0xFD,0x04,0x32,0xFA,
0x38,0x48,0x54,0x48,0x54,0x48,0x90,0x48,0x10,0x88,0x10,0x88,0x11,0x28,0x12,0x10
};/*"粉",1*/
static const unsigned char PROGMEM name8_2[] =
{
  0x00,0x02,0x3F,0xC2,0x20,0x42,0x20,0x42,0x3F,0xD2,0x22,0x12,0x22,0x12,0x22,0x12,
0x3F,0xD2,0x52,0x52,0x52,0x52,0x52,0x52,0x93,0x42,0x12,0x82,0x02,0x0A,0x02,0x04
};/*"刷",2*/
static const unsigned char PROGMEM name8_3[] =
{
  0x00,0x00,0x7F,0xFC,0x40,0x00,0x40,0x38,0x47,0xC0,0x44,0x00,0x44,0x00,0x47,0xFC,
0x44,0x20,0x44,0x20,0x44,0x20,0x48,0x20,0x48,0x20,0x50,0x20,0x7F,0xFE,0x00,0x00
};/*"匠",3*/

//9.卖报歌
static const unsigned char PROGMEM name9_1[] =
{
  0x01,0x00,0x01,0x00,0x3F,0xF8,0x01,0x00,0x01,0x00,0x7F,0xFC,0x04,0x04,0x02,0x88,
0x12,0x80,0x08,0x80,0x09,0x00,0xFF,0xFE,0x02,0x40,0x04,0x20,0x18,0x10,0x60,0x08
};/*"卖",1*/
static const unsigned char PROGMEM name9_2[] =
{
  0x10,0x00,0x11,0xFC,0x11,0x04,0x11,0x04,0xFD,0x14,0x11,0x08,0x11,0x00,0x15,0xFC,
0x19,0x44,0x31,0x44,0xD1,0x28,0x11,0x28,0x11,0x10,0x11,0x28,0x51,0x44,0x21,0x82
};/*"报",2*/
static const unsigned char PROGMEM name9_3[] =
{
  0x00,0x20,0xFF,0x20,0x02,0x20,0x7A,0x7E,0x4A,0x42,0x7A,0x84,0x00,0x10,0xFF,0x10,
0x02,0x10,0x7A,0x10,0x4A,0x28,0x4A,0x28,0x7A,0x28,0x02,0x44,0x0A,0x44,0x04,0x82
};/*"歌",3*/

//10.小毛驴
static const unsigned char PROGMEM name10_1[] =
{
  0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00,0x11,0x10,0x11,0x08,0x11,0x04,
0x21,0x04,0x21,0x02,0x41,0x02,0x81,0x02,0x01,0x00,0x01,0x00,0x05,0x00,0x02,0x00
};/*"小",1*/
static const unsigned char PROGMEM name10_2[] =
{
  0x00,0x10,0x01,0xF8,0x7E,0x00,0x02,0x00,0x02,0x00,0x03,0xF0,0x3E,0x00,0x02,0x00,
0x02,0x00,0x03,0xFC,0xFE,0x00,0x02,0x00,0x02,0x04,0x02,0x04,0x02,0x04,0x01,0xFC
};/*"毛",2*/
static const unsigned char PROGMEM name10_3[] =
{
  0x00,0x40,0xF8,0x20,0x08,0x20,0x48,0xFC,0x48,0x84,0x48,0x84,0x48,0x84,0x7C,0xFC,
0x04,0x84,0x04,0x80,0x1C,0x80,0xE4,0x80,0x44,0x80,0x05,0x00,0x29,0x00,0x12,0x00
};/*"驴",3*/


String songs_name[10]={"爱拼才会赢","小星星","两只老虎","生日快乐","蜗牛","一分钱","上学歌","粉刷匠","卖报歌","小毛驴"};
//*********************************************


//*******************************
//每一首歌名总数组
const unsigned char *names_1[5]={name1_1,name1_2,name1_3,name1_4,name1_5};
const unsigned char *names_2[3]={name2_1,name2_2,name2_3};
const unsigned char *names_3[4]={name3_1,name3_2,name3_3,name3_4};
const unsigned char *names_4[4]={name4_1,name4_2,name4_3,name4_4};
const unsigned char *names_5[2]={name5_1,name5_2};
const unsigned char *names_6[3]={name6_1,name6_2,name6_3};
const unsigned char *names_7[3]={name7_1,name7_2,name7_3};
const unsigned char *names_8[3]={name8_1,name8_2,name8_3};
const unsigned char *names_9[3]={name9_1,name9_2,name9_3};
const unsigned char *names_10[3]={name10_1,name10_2,name10_3};
//所有歌，即names[i][j]为第i+1首歌的歌名 的第j个字
const unsigned char **names[G]={names_1,names_2,names_3,names_4,names_5,names_6,names_7,names_8,names_9,names_10};
//每首歌名字长度
char len_names[]={5,3,4,4,2,3,3,3,3,3};
//******************************


//歌曲长度*************
int length[G]=
{
  sizeof(tune1)/sizeof(tune1[0]),
  sizeof(tune2)/sizeof(tune2[0]),
  sizeof(tune3)/sizeof(tune3[0]),
  sizeof(tune4)/sizeof(tune4[0]),
  sizeof(tune5)/sizeof(tune5[0]),
  sizeof(tune6)/sizeof(tune6[0]),
  sizeof(tune7)/sizeof(tune7[0]),
  sizeof(tune8)/sizeof(tune8[0]),
  sizeof(tune9)/sizeof(tune9[0]),
  sizeof(tune10)/sizeof(tune10[0])
};
//***********************
  
//暂停的中断函数***********
bool pause=false;
void pauseInterrupt(){
  pause = true;
}
//**************************

//**************LED点阵*********************
unsigned char row[]={3,10,7,9,5,6,4,8};
unsigned char col[]={37,45,39,33,43,41,31,35};
void light(unsigned char x,unsigned char y)//点亮第x行，第y列的点
{
  analogWrite(row[x-1],5);
  analogWrite(col[y-1],0);  
}

void lightClear()//全部熄灭
{
  for(int i=3;i<=10;i++)
    analogWrite(i,0);
}

void lights(unsigned char len_rows,unsigned char len_cols,unsigned char rows[],unsigned char cols[])//点亮指定行、列的点集
{
  for(int a=0;a<len_rows;a++)
    analogWrite(row[rows[a]-1],5);
  for(int b=0;b<len_cols;b++)
    analogWrite(col[cols[b]-1],0);
}

void lightAllCols(unsigned char a[])//a是长度为8的数组，代表8列分别亮多少个灯
{
  for(int i=7;i>=0;i--){
    for(int j=a[i];j>=1;j--)
      light(i+1,j);
      //analogRead()
      delay(200);
  }
}
//*******************************

void setup()
{ 
  //串口通信
  Serial.begin(9600);
  
  pinMode(TONE_PIN,OUTPUT);//将连接蜂鸣器的引脚设置为输出
  //将连接各个按键的引脚设置为 输入上拉状态
  pinMode(PLAY_PIN,INPUT_PULLUP);
  pinMode(PAUSE_PIN,INPUT_PULLUP);
  pinMode(FAST_FORWARD_PIN,INPUT_PULLUP);
  pinMode(REWIND_PIN,INPUT_PULLUP);
  pinMode(SWITCH_NEXT_PIN,INPUT_PULLUP);
  //中断引脚编号为int0，即2号引脚，高电平变低电平时触发，中断函数为pause，用于暂停歌曲播放
  attachInterrupt(0,pauseInterrupt,FALLING);
  //pause默认为false，按下暂停按键时才会变为true
  pause=false;

  //OLED屏幕
  display.begin(SSD1306_SWITCHCAPVCC, 0x3C);  // initialize with the I2C addr 0x3D (for the 128x64) 

  //点阵
  char d;
  for(d=3;d<=10;d++)
    pinMode(d,OUTPUT);
  for(d=31;d<=45;d+=2)  
    pinMode(d,OUTPUT);
  //for(d=3;d<=10;d++)
  //  analogWrite(d,5);
  //analogWrite(3,5);//第1行
  //analogWrite(4,5);//第7行
  //analogWrite(5,5);//第5行
  //analogWrite(6,5);//第6行
  //analogWrite(7,5);//第3行
  //analogWrite(8,5);//第8行
  //analogWrite(9,5);//第4行
  //analogWrite(10,5);//第2行
  for(d=31;d<=45;d+=2)  
    analogWrite(d,255);
  //analogWrite(31,0);//第7列
  //analogWrite(33,0);//第4列
  //analogWrite(35,0);//第8列
  //analogWrite(37,0);//第1列
  //analogWrite(39,0);//第3列
  //analogWrite(41,0);//第6列
  //analogWrite(43,0);//第5列
  //analogWrite(45,0);//第2列

}

void loop()
{
  for(int i=0;i<G;i++){
    //每首歌都需要按下播放键才开始播放
    digitalWrite(PLAY_PIN,HIGH);
    while (digitalRead(PLAY_PIN)==HIGH){
      
      //上位机通信，查看歌单
      unsigned char a[]={1,2,3,4,5,6,7,8};
      if (Serial.available()!=0) {
        if (Serial.read()=='k'){Serial.println(G); lightAllCols(a);
          for(int i=0;i<G;i++){
            Serial.println(songs_name[i]);  
          }
        } 
      }
        
    }
    delay(500);
    //开始播放
    for(int x=0;x<length[i];x++)
    {
      display.clearDisplay(); // clears the screen and buffer
      //显示“当前播放：”
      display.drawBitmap(0,0,str1_1,16,16,WHITE);   
      display.drawBitmap(16,0,str1_2,16,16,WHITE);
      display.drawBitmap(32,0,str1_3,16,16,WHITE);
      display.drawBitmap(48,0,str1_4,16,16,WHITE);
      display.drawBitmap(64,0,str1_5,16,16,WHITE);
      //显示歌名
      for(int j=0;j<len_names[i];j++){
        display.drawBitmap(16*j,16,names[i][j],16,16,WHITE);
      }
      //显示“下一首：”
      display.drawBitmap(0,32,str2_1,16,16,WHITE);   
      display.drawBitmap(16,32,str2_2,16,16,WHITE);
      display.drawBitmap(32,32,str2_3,16,16,WHITE);
      display.drawBitmap(48,32,str2_4,16,16,WHITE);
      //显示下一首歌名字,最后一首时显示第一首
      if (i<G-1){
        for(int j=0;j<len_names[i+1];j++){
          display.drawBitmap(16*j,48,names[i+1][j],16,16,WHITE);
        }
      }
      else{
        for(int j=0;j<len_names[0];j++){
          display.drawBitmap(16*j,48,names[0][j],16,16,WHITE);
        }
      }
      
      display.setTextSize(1); //设置字体大小
      display.setCursor(75, 0);//设置显示位置
      display.setTextColor(WHITE);
      display.print((((float)(x+1)/length[i]))*100);//显示播放进度
      display.print("%");
      //刷新屏幕并显示
      display.display();
      while (pause){//暂停
        if (digitalRead(PAUSE_PIN)==LOW){//继续
          delay(200);
          pause=false;
        }
      }
      //快进
      if (digitalRead(FAST_FORWARD_PIN)==LOW && x<length-3){
        x+=3;
        digitalWrite(FAST_FORWARD_PIN,HIGH);
      }
      //快退
      if (digitalRead(REWIND_PIN)==LOW && x>2){
        x-=3;
        digitalWrite(REWIND_PIN,HIGH);
      }
      //下一首
      if (digitalRead(SWITCH_NEXT_PIN)==LOW && i<G){
        digitalWrite(SWITCH_NEXT_PIN,HIGH);
        break;
      }
      //发声
      tone(TONE_PIN,tunes[i][x]);
      delay(500*durts[i][x]);   //这里用来根据节拍调节延时，500这个指数可以调。
      noTone(TONE_PIN);
    }
  }
  
  //delay(1000); //播放完停1秒
}
